<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CredCheck - Certificate Verification Platform</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/qrcode/1.5.3/qrcode.min.js"></script>
    <style>
        .glassmorphism {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
        }
        .gradient-bg {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        }
    </style>
</head>
<body class="gradient-bg min-h-screen">
    <div id="app"></div>

    <script>
        // App State
        let appState = {
            currentUser: null,
            currentPage: 'home',
            users: [
                { _id: '1', name: 'John Doe', email: 'john@gmail.com', role: 'student', college: 'MIT', verified: true, createdAt: new Date() },
                { _id: '2', name: 'Tech Corp', email: 'verify@techcorp.com', role: 'verifier', verified: true, createdAt: new Date() },
                { _id: '3', name: 'Admin User', email: 'admin@credcheck.com', role: 'admin', verified: true, createdAt: new Date() }
            ],
            certificates: [
                {
                    _id: 'cert1',
                    studentId: '1',
                    title: 'Full Stack Development Internship',
                    organization: 'Tech Corp',
                    fileUrl: '#',
                    verifierEmail: 'verify@techcorp.com',
                    status: 'verified',
                    comments: 'Excellent performance during the internship',
                    publicLinkId: 'abc123',
                    qrCodeUrl: '',
                    createdAt: new Date('2024-01-15')
                }
            ],
            verifierRequests: []
        };

        // Utility Functions
        function generateId() {
            return Math.random().toString(36).substr(2, 9);
        }

        function generateQRCode(text, callback) {
            const canvas = document.createElement('canvas');
            QRCode.toCanvas(canvas, text, function (error) {
                if (error) console.error(error);
                else callback(canvas.toDataURL());
            });
        }

        // Navigation
        function navigateTo(page) {
            appState.currentPage = page;
            render();
        }

        function logout() {
            appState.currentUser = null;
            navigateTo('home');
        }

        // Event Handlers
        function handleLogin() {
            const email = document.getElementById('loginEmail').value;
            const role = document.getElementById('loginRole').value;
            
            if (!email) {
                alert('Please enter your email');
                return;
            }
            
            let user = appState.users.find(u => u.email === email && u.role === role);
            if (!user) {
                user = {
                    _id: generateId(),
                    name: email.split('@')[0],
                    email: email,
                    role: role,
                    college: role === 'student' ? 'Demo University' : undefined,
                    verified: true,
                    createdAt: new Date()
                };
                appState.users.push(user);
            }
            
            appState.currentUser = user;
            navigateTo(role === 'student' ? 'student' : role === 'verifier' ? 'verifier' : 'admin');
        }

        function handleCertUpload(event) {
            event.preventDefault();
            
            const title = document.getElementById('certTitle').value;
            const organization = document.getElementById('certOrg').value;
            const verifierEmail = document.getElementById('verifierEmail').value;
            const description = document.getElementById('certDesc').value;
            
            const newCert = {
                _id: generateId(),
                studentId: appState.currentUser._id,
                title: title,
                organization: organization,
                fileUrl: '#',
                verifierEmail: verifierEmail,
                status: 'pending',
                comments: '',
                publicLinkId: generateId(),
                qrCodeUrl: '',
                createdAt: new Date()
            };
            
            appState.certificates.push(newCert);
            alert('Certificate submitted for verification!');
            navigateTo('student');
        }

        function handleVerification(certId, status) {
            const cert = appState.certificates.find(c => c._id === certId);
            if (cert) {
                const comments = status === 'verified' 
                    ? prompt('Add verification comments (optional):') || 'Verified successfully'
                    : prompt('Add rejection reason:') || 'Did not meet verification criteria';
                
                cert.status = status;
                cert.comments = comments;
                
                alert(`Certificate ${status} successfully!`);
                render();
            }
        }

        function viewCertificate(publicLinkId) {
            appState.viewingCertId = publicLinkId;
            navigateTo('cert-view');
        }

        function generateQR(publicLinkId) {
            const publicUrl = `https://credcheck.com/cert/${publicLinkId}`;
            generateQRCode(publicUrl, (qrDataUrl) => {
                const modal = document.createElement('div');
                modal.className = 'fixed inset-0 bg-black/50 flex items-center justify-center z-50';
                modal.innerHTML = `
                    <div class="bg-white rounded-lg p-6 max-w-sm mx-4">
                        <h3 class="text-xl font-bold mb-4">Certificate QR Code</h3>
                        <div class="text-center mb-4">
                            <img src="${qrDataUrl}" alt="QR Code" class="mx-auto">
                        </div>
                        <p class="text-sm text-gray-600 mb-4">Scan this QR code to verify the certificate</p>
                        <button onclick="this.closest('.fixed').remove()" class="w-full bg-blue-500 text-white px-4 py-2 rounded">Close</button>
                    </div>
                `;
                document.body.appendChild(modal);
            });
        }

        function handleVerifierRequest(event) {
            event.preventDefault();
            
            const orgName = document.getElementById('orgName').value;
            const orgEmail = document.getElementById('orgEmail').value;
            const orgDetails = document.getElementById('orgDetails').value;
            
            const request = {
                _id: generateId(),
                organizationName: orgName,
                email: orgEmail,
                details: orgDetails,
                status: 'pending',
                requestedAt: new Date()
            };
            
            appState.verifierRequests.push(request);
            alert('Verifier request submitted! We will review and get back to you.');
            navigateTo('login');
        }

        // Render Functions
        function render() {
            const app = document.getElementById('app');
            const user = appState.currentUser;
            
            let content = renderNavbar(user);
            content += '<div class="container mx-auto px-4">';
            
            switch(appState.currentPage) {
                case 'home':
                    content += renderHomePage(user);
                    break;
                case 'login':
                    content += renderLoginPage();
                    break;
                case 'student':
                    content += renderStudentDashboard(user);
                    break;
                case 'upload-cert':
                    content += renderUploadCertPage();
                    break;
                case 'verifier':
                    content += renderVerifierDashboard();
                    break;
                case 'admin':
                    content += renderAdminDashboard();
                    break;
                case 'cert-view':
                    content += renderPublicCertView();
                    break;
                case 'verify-request':
                    content += renderVerifyRequestPage();
                    break;
                default:
                    content += renderHomePage(user);
            }
            
            content += '</div>';
            app.innerHTML = content;
        }

        function renderNavbar(user) {
            return `
                <nav class="glassmorphism p-4 mb-6">
                    <div class="max-w-6xl mx-auto flex justify-between items-center">
                        <div class="flex items-center space-x-2 cursor-pointer" onclick="navigateTo('home')">
                            <h1 class="text-2xl font-bold text-white">🎓 CredCheck</h1>
                        </div>
                        <div class="flex items-center space-x-4">
                            ${user ? `
                                <span class="text-white">Welcome, ${user.name}</span>
                                <button onclick="logout()" class="bg-red-500 hover:bg-red-600 text-white px-4 py-2 rounded">
                                    Logout
                                </button>
                            ` : `
                                <button onclick="navigateTo('login')" class="bg-blue-500 hover:bg-blue-600 text-white px-4 py-2 rounded">
                                    Login
                                </button>
                            `}
                        </div>
                    </div>
                </nav>
            `;
        }

        function renderHomePage(user) {
            if (!user) {
                return `
                    <div class="text-center text-white py-20">
                        <h1 class="text-6xl font-bold mb-4">🎓 CredCheck</h1>
                        <p class="text-2xl mb-8">Certificate & Internship Verification Platform</p>
                        <p class="text-lg mb-8 max-w-2xl mx-auto text-white/80">
                            Secure, reliable certificate verification for students, employers, and educational institutions.
                        </p>
                        <div class="space-x-4">
                            <button onclick="navigateTo('login')" class="bg-blue-600 hover:bg-blue-700 text-white px-8 py-4 rounded-lg text-lg font-semibold">
                                Get Started
                            </button>
                            <button onclick="navigateTo('verify-request')" class="bg-green-600 hover:bg-green-700 text-white px-8 py-4 rounded-lg text-lg font-semibold">
                                Become a Verifier
                            </button>
                        </div>
                    </div>
                `;
            } else {
                const dashboard = user.role === 'student' ? 'student' : user.role === 'verifier' ? 'verifier' : 'admin';
                return `
                    <div class="text-center text-white py-20">
                        <h1 class="text-4xl font-bold mb-4">Welcome back, ${user.name}!</h1>
                        <p class="text-lg mb-8">Ready to manage your certificates?</p>
                        <button onclick="navigateTo('${dashboard}')" class="bg-blue-600 hover:bg-blue-700 text-white px-8 py-4 rounded-lg text-lg font-semibold">
                            Go to Dashboard
                        </button>
                    </div>
                `;
            }
        }

        function renderLoginPage() {
            return `
                <div class="max-w-md mx-auto glassmorphism rounded-lg p-8">
                    <h2 class="text-3xl font-bold text-white text-center mb-6">Login to CredCheck</h2>
                    <div class="space-y-4">
                        <div>
                            <label class="block text-white mb-2">Email</label>
                            <input type="email" id="loginEmail" class="w-full p-3 rounded bg-white/20 text-white placeholder-gray-300" placeholder="Enter your email">
                        </div>
                        <div>
                            <label class="block text-white mb-2">Role</label>
                            <select id="loginRole" class="w-full p-3 rounded bg-white/20 text-white">
                                <option value="student">Student</option>
                                <option value="verifier">Verifier</option>
                                <option value="admin">Admin</option>
                            </select>
                        </div>
                        <button onclick="handleLogin()" class="w-full bg-blue-600 hover:bg-blue-700 text-white p-3 rounded font-semibold">
                            🚀 Login (Demo)
                        </button>
                        <div class="text-center">
                            <button onclick="navigateTo('verify-request')" class="text-blue-300 hover:text-blue-200 underline">
                                Become a Verifier
                            </button>
                        </div>
                    </div>
                </div>
            `;
        }

        function renderStudentDashboard(user) {
            const userCerts = appState.certificates.filter(cert => cert.studentId === user._id);
            
            return `
                <div class="max-w-6xl mx-auto space-y-6">
                    <div class="glassmorphism rounded-lg p-6">
                        <h2 class="text-2xl font-bold text-white mb-4">📚 My Certificates</h2>
                        <button onclick="navigateTo('upload-cert')" class="bg-green-500 hover:bg-green-600 text-white px-6 py-3 rounded font-semibold mb-4">
                            ➕ Upload New Certificate
                        </button>
                        
                        <div class="grid gap-4">
                            ${userCerts.length === 0 ? `
                                <div class="text-center text-white/70 py-8">
                                    <p class="text-lg">No certificates uploaded yet.</p>
                                    <p>Upload your first certificate to get started!</p>
                                </div>
                            ` : userCerts.map(cert => `
                                <div class="bg-white/10 rounded-lg p-4 border border-white/20">
                                    <div class="flex justify-between items-start">
                                        <div class="flex-1">
                                            <h3 class="text-xl font-semibold text-white">${cert.title}</h3>
                                            <p class="text-white/80">Organization: ${cert.organization}</p>
                                            <p class="text-white/60">Submitted: ${new Date(cert.createdAt).toLocaleDateString()}</p>
                                            ${cert.comments ? `<p class="text-white/60 mt-2">Comments: ${cert.comments}</p>` : ''}
                                        </div>
                                        <div class="text-right">
                                            <span class="px-3 py-1 rounded-full text-sm font-semibold ${
                                                cert.status === 'verified' ? 'bg-green-500 text-white' :
                                                cert.status === 'pending' ? 'bg-yellow-500 text-black' :
                                                'bg-red-500 text-white'
                                            }">
                                                ${cert.status.toUpperCase()}
                                            </span>
                                            ${cert.status === 'verified' ? `
                                                <div class="mt-2 space-y-2">
                                                    <button onclick="viewCertificate('${cert.publicLinkId}')" 
                                                            class="block w-full bg-blue-500 hover:bg-blue-600 text-white px-3 py-1 rounded text-sm">
                                                        View Public Link
                                                    </button>
                                                    <button onclick="generateQR('${cert.publicLinkId}')" 
                                                            class="block w-full bg-purple-500 hover:bg-purple-600 text-white px-3 py-1 rounded text-sm">
                                                        Generate QR Code
                                                    </button>
                                                </div>
                                            ` : ''}
                                        </div>
                                    </div>
                                </div>
                            `).join('')}
                        </div>
                    </div>
                </div>
            `;
        }

        function renderUploadCertPage() {
            return `
                <div class="max-w-2xl mx-auto glassmorphism rounded-lg p-8">
                    <h2 class="text-3xl font-bold text-white text-center mb-6">📤 Upload Certificate</h2>
                    <form onsubmit="handleCertUpload(event)" class="space-y-6">
                        <div>
                            <label class="block text-white mb-2">Certificate Title</label>
                            <input type="text" id="certTitle" required class="w-full p-3 rounded bg-white/20 text-white placeholder-gray-300" placeholder="e.g., Full Stack Development Internship">
                        </div>
                        <div>
                            <label class="block text-white mb-2">Organization/Company</label>
                            <input type="text" id="certOrg" required class="w-full p-3 rounded bg-white/20 text-white placeholder-gray-300" placeholder="e.g., Tech Corp">
                        </div>
                        <div>
                            <label class="block text-white mb-2">Verifier Email</label>
                            <input type="email" id="verifierEmail" required class="w-full p-3 rounded bg-white/20 text-white placeholder-gray-300" placeholder="verify@company.com">
                        </div>
                        <div>
                            <label class="block text-white mb-2">Description</label>
                            <textarea id="certDesc" rows="4" class="w-full p-3 rounded bg-white/20 text-white placeholder-gray-300" placeholder="Brief description of the certificate/internship"></textarea>
                        </div>
                        <div class="flex space-x-4">
                            <button type="submit" class="flex-1 bg-green-600 hover:bg-green-700 text-white p-3 rounded font-semibold">
                                🚀 Submit for Verification
                            </button>
                            <button type="button" onclick="navigateTo('student')" class="bg-gray-600 hover:bg-gray-700 text-white px-6 py-3 rounded">
                                Cancel
                            </button>
                        </div>
                    </form>
                </div>
            `;
        }

        function renderVerifierDashboard() {
            const pendingCerts = appState.certificates.filter(cert => cert.status === 'pending');
            
            return `
                <div class="max-w-6xl mx-auto space-y-6">
                    <div class="glassmorphism rounded-lg p-6">
                        <h2 class="text-2xl font-bold text-white mb-4">🔍 Verification Requests</h2>
                        
                        <div class="grid gap-4">
                            ${pendingCerts.length === 0 ? `
                                <div class="text-center text-white/70 py-8">
                                    <p class="text-lg">No pending verification requests.</p>
                                </div>
                            ` : pendingCerts.map(cert => {
                                const student = appState.users.find(u => u._id === cert.studentId);
                                return `
                                    <div class="bg-white/10 rounded-lg p-6 border border-white/20">
                                        <div class="flex justify-between items-start">
                                            <div class="flex-1">
                                                <h3 class="text-xl font-semibold text-white">${cert.title}</h3>
                                                <p class="text-white/80">Student: ${student ? student.name : 'Unknown'}</p>
                                                <p class="text-white/80">Organization: ${cert.organization}</p>
                                                <p class="text-white/60">Submitted: ${new Date(cert.createdAt).toLocaleDateString()}</p>
                                            </div>
                                            <div class="flex space-x-2">
                                                <button onclick="handleVerification('${cert._id}', 'verified')" 
                                                        class="bg-green-500 hover:bg-green-600 text-white px-4 py-2 rounded">
                                                    ✅ Approve
                                                </button>
                                                <button onclick="handleVerification('${cert._id}', 'rejected')" 
                                                        class="bg-red-500 hover:bg-red-600 text-white px-4 py-2 rounded">
                                                    ❌ Reject
                                                </button>
                                            </div>
                                        </div>
                                    </div>
                                `;
                            }).join('')}
                        </div>
                    </div>
                </div>
            `;
        }

        function renderAdminDashboard() {
            return `
                <div class="max-w-6xl mx-auto space-y-6">
                    <!-- Stats Cards -->
                    <div class="grid grid-cols-1 md:grid-cols-4 gap-4">
                        <div class="glassmorphism rounded-lg p-6 text-center">
                            <h3 class="text-lg font-semibold text-white">Total Users</h3>
                            <p class="text-3xl font-bold text-blue-400">${appState.users.length}</p>
                        </div>
                        <div class="glassmorphism rounded-lg p-6 text-center">
                            <h3 class="text-lg font-semibold text-white">Certificates</h3>
                            <p class="text-3xl font-bold text-green-400">${appState.certificates.length}</p>
                        </div>
                        <div class="glassmorphism rounded-lg p-6 text-center">
                            <h3 class="text-lg font-semibold text-white">Verified Certs</h3>
                            <p class="text-3xl font-bold text-yellow-400">${appState.certificates.filter(c => c.status === 'verified').length}</p>
                        </div>
                        <div class="glassmorphism rounded-lg p-6 text-center">
                            <h3 class="text-lg font-semibold text-white">Pending Requests</h3>
                            <p class="text-3xl font-bold text-red-400">${appState.verifierRequests.filter(r => r.status === 'pending').length}</p>
                        </div>
                    </div>

                    <!-- Users Management -->
                    <div class="glassmorphism rounded-lg p-6">
                        <h2 class="text-2xl font-bold text-white mb-4">👥 Users Management</h2>
                        <div class="overflow-x-auto">
                            <table class="w-full text-white">
                                <thead>
                                    <tr class="border-b border-white/20">
                                        <th class="text-left p-2">Name</th>
                                        <th class="text-left p-2">Email</th>
                                        <th class="text-left p-2">Role</th>
                                        <th class="text-left p-2">Status</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    ${appState.users.map(user => `
                                        <tr class="border-b border-white/10">
                                            <td class="p-2">${user.name}</td>
                                            <td class="p-2">${user.email}</td>
                                            <td class="p-2">${user.role}</td>
                                            <td class="p-2">
                                                <span class="px-2 py-1 rounded text-sm ${user.verified ? 'bg-green-500' : 'bg-yellow-500'}">
                                                    ${user.verified ? 'Verified' : 'Pending'}
                                                </span>
                                            </td>
                                        </tr>
                                    `).join('')}
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            `;
        }

        function renderPublicCertView() {
            const cert = appState.certificates.find(c => c.publicLinkId === appState.viewingCertId);
            if (!cert) {
                return `
                    <div class="max-w-2xl mx-auto glassmorphism rounded-lg p-8 text-center">
                        <h2 class="text-2xl font-bold text-white mb-4">Certificate Not Found</h2>
                        <p class="text-white/80">The certificate you're looking for doesn't exist or has been removed.</p>
                    </div>
                `;
            }

            const student = appState.users.find(u => u._id === cert.studentId);
            
            return `
                <div class="max-w-2xl mx-auto glassmorphism rounded-lg p-8">
                    <div class="text-center mb-6">
                        <h1 class="text-3xl font-bold text-white mb-2">🎓 Certificate Verification</h1>
                        <div class="w-16 h-1 bg-green-400 mx-auto rounded"></div>
                    </div>
                    
                    <div class="bg-white/10 rounded-lg p-6 border border-white/20">
                        <div class="text-center mb-6">
                            <h2 class="text-2xl font-bold text-white mb-2">${cert.title}</h2>
                            <p class="text-xl text-white/80">${student ? student.name : 'Unknown Student'}</p>
                        </div>
                        
                        <div class="space-y-4">
                            <div class="flex justify-between border-b border-white/20 pb-2">
                                <span class="text-white/70">Organization:</span>
                                <span class="text-white font-semibold">${cert.organization}</span>
                            </div>
                            <div class="flex justify-between border-b border-white/20 pb-2">
                                <span class="text-white/70">Student:</span>
                                <span class="text-white font-semibold">${student ? student.name : 'Unknown'}</span>
                            </div>
                            <div class="flex justify-between border-b border-white/20 pb-2">
                                <span class="text-white/70">College:</span>
                                <span class="text-white font-semibold">${student?.college || 'Not specified'}</span>
                            </div>
                            <div class="flex justify-between border-b border-white/20 pb-2">
                                <span class="text-white/70">Issue Date:</span>
                                <span class="text-white font-semibold">${new Date(cert.createdAt).toLocaleDateString()}</span>
                            </div>
                            <div class="flex justify-between border-b border-white/20 pb-2">
                                <span class="text-white/70">Status:</span>
                                <span class="px-3 py-1 rounded-full bg-green-500 text-white font-semibold">
                                    ✅ VERIFIED
                                </span>
                            </div>
                        </div>
                        
                        ${cert.comments ? `
                            <div class="mt-6 p-4 bg-white/5 rounded-lg">
                                <h3 class="text-white font-semibold mb-2">Verifier Comments:</h3>
                                <p class="text-white/80">${cert.comments}</p>
                            </div>
                        ` : ''}
                        
                        <div class="mt-6 text-center">
                            <div class="inline-flex items-center space-x-2 bg-green-500/20 text-green-400 px-4 py-2 rounded-lg">
                                <span class="text-2xl">🔒</span>
                                <span class="font-semibold">This certificate has been verified and is authentic</span>
                            </div>
                        </div>
                    </div>
                    
                    <div class="text-center mt-6">
                        <p class="text-white/60">Powered by CredCheck - Certificate Verification Platform</p>
                    </div>
                </div>
            `;
        }

        function renderVerifyRequestPage() {
            return `
                <div class="max-w-2xl mx-auto glassmorphism rounded-lg p-8">
                    <h2 class="text-3xl font-bold text-white text-center mb-6">🏢 Become a Verifier</h2>
                    <form onsubmit="handleVerifierRequest(event)" class="space-y-6">
                        <div>
                            <label class="block text-white mb-2">Organization Name</label>
                            <input type="text" id="orgName" required class="w-full p-3 rounded bg-white/20 text-white placeholder-gray-300" placeholder="Your Company/Organization">
                        </div>
                        <div>
                            <label class="block text-white mb-2">Official Email</label>
                            <input type="email" id="orgEmail" required class="w-full p-3 rounded bg-white/20 text-white placeholder-gray-300" placeholder="verify@company.com">
                        </div>
                        <div>
                            <label class="block text-white mb-2">Organization Details</label>
                            <textarea id="orgDetails" rows="4" class="w-full p-3 rounded bg-white/20 text-white placeholder-gray-300" placeholder="Brief description of your organization"></textarea>
                        </div>
                        <div class="flex space-x-4">
                            <button type="submit" class="flex-1 bg-blue-600 hover:bg-blue-700 text-white p-3 rounded font-semibold">
                                📝 Submit Request
                            </button>
                            <button type="button" onclick="navigateTo('login')" class="bg-gray-600 hover:bg-gray-700 text-white px-6 py-3 rounded">
                                Back to Login
                            </button>
                        </div>
                    </form>
                </div>
            `;
        }

        // Initialize the app
        render();
    </script>
</body>
</html>